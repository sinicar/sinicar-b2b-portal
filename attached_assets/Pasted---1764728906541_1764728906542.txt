⚠️ تنبيه مهم جدًا قبل أي تعديل:
لا تقم بحذف أو إعادة تهيئة أي بيانات أو جداول موجودة للمنتجات. لا تغيّر مفاتيح LocalStorage الحالية. المطلوب هو فقط إضافة دعم لاستيراد المنتجات من ملف Excel بنفس تقسيمة نظام أونيكس برو الذي سأذكرها، مع استخدام الحقول المهمة (رقم الصنف، اسم الصنف، مستويات التسعير، الكميات) وترك باقي الحقول اختيارية أو فارغة.

مواصفات ملف الأكسل القادم من النظام المحاسبي:
الملف يحتوي أعمدة بالعربية، أهمها كالتالي (مع نفس أسماء الأعمدة حرفيًا):

- 'رقم الصنف'
- 'اسم الصنف'
- 'سعر التجزئة'
- 'سعر الجملة'
- 'سعر جملة الجملة'
- 'سعر المتجر الالكتروني'
- '  كمية المخزن 103'
- '  كمية المخزن 105'
- 'الإجمالي'

وتوجد أعمدة أخرى مثل:
- 'الصورة ', 'رقم التصنيع', ' المواصفات', ' الماركة', ' اسم السيارة',
  ' التصنيف العالمي', ' سنة الصنع', 'الجودة', 'التكلفة', 'رف المخزن 103', 'رف المخزن 105',
  'نوع التصنيف', 'المجموعة التفصيلية', 'المجموعة المماثلة' ...
هذه الحقول **لا نريد استخدامها الآن** في النظام (تظل اختيارية أو فارغة).

━━━━━━━━━━━━━━━━━━
أولاً: تعريف نوع المنتج في types.ts
━━━━━━━━━━━━━━━━━━

في ملف types.ts عدّل/أضف نوع Product بحيث يدعم هذه الحقول (بدون حذف أي حقل قديم إن وجد):

export interface Product {
  id: string;                 // معرّف داخلي (UUID أو رقم تلقائي)
  partNumber: string;         // رقم الصنف من عمود "رقم الصنف"
  name: string;               // اسم الصنف من عمود "اسم الصنف"

  // مستويات التسعير:
  priceRetail?: number | null;        // من "سعر التجزئة"
  priceWholesale?: number | null;     // من "سعر الجملة"
  priceWholeWholesale?: number | null;// من "سعر جملة الجملة"
  priceEcommerce?: number | null;     // من "سعر المتجر الالكتروني"

  // الكميات:
  qtyStore103?: number | null;        // من "  كمية المخزن 103"
  qtyStore105?: number | null;        // من "  كمية المخزن 105"
  qtyTotal?: number | null;           // من "الإجمالي"

  // حقول إضافية (اختيارية – تُترك فارغة حالياً):
  manufacturerPartNumber?: string | null; // من "رقم التصنيع" إذا احتجناه لاحقاً
  description?: string | null;           // من " المواصفات"
  brand?: string | null;                // من " الماركة"
  carName?: string | null;              // من " اسم السيارة"
  globalCategory?: string | null;       // من " التصنيف العالمي"
  modelYear?: string | null;            // من " سنة الصنع"
  quality?: string | null;              // من "الجودة"

  // مواقع الرفوف (اختيارية):
  rack103?: string | null;             // من "رف المخزن 103"
  rack105?: string | null;             // من "رف المخزن 105"

  // حقول نظامية:
  createdAt: string;
  updatedAt?: string;
}

- اجعل جميع الحقول (ما عدا id, partNumber, name) اختيارية حتى لا تنكسر البيانات القديمة.

━━━━━━━━━━━━━━━━━━
ثانياً: منطق الاستيراد من Excel في mockApi.ts
━━━━━━━━━━━━━━━━━━

أريد دالة في services/mockApi.ts باسم مثلاً:

async function importProductsFromOnyxExcel(file: File): Promise<{ imported: number; skipped: number; errors: string[] }>

هذه الدالة تقوم بـ:

1) استخدام مكتبة xlsx لقراءة الملف (نفس المكتبة الموجودة في المشروع).
2) قراءة أول شيت في الملف.
3) استخراج الصفوف إلى JSON، مع المحافظة على أسماء الأعمدة كما هي.
4) لكل صف:

   - تجاهل الصف إذا كان "رقم الصنف" فارغًا.
   - إنشاء Product جديد بالقيم التالية:

     const product: Product = {
       id: generateId(), // أي دالة توليد ID مستخدمة في المشروع
       partNumber: row['رقم الصنف']?.toString().trim(),
       name: row['اسم الصنف']?.toString().trim(),

       priceRetail: parseNumber(row['سعر التجزئة']),
       priceWholesale: parseNumber(row['سعر الجملة']),
       priceWholeWholesale: parseNumber(row['سعر جملة الجملة']),
       priceEcommerce: parseNumber(row['سعر المتجر الالكتروني']),

       qtyStore103: parseNumber(row['  كمية المخزن 103']),
       qtyStore105: parseNumber(row['  كمية المخزن 105']),
       qtyTotal: parseNumber(row['الإجمالي']),

       // الحقول الأخرى تُترك فارغة أو اختيارية الآن:
       // manufacturerPartNumber: row['رقم التصنيع'] ? String(row['رقم التصنيع']) : null,
       // ...إلخ (اختياري)

       createdAt: new Date().toISOString(),
     };

   - إذا كان هناك منتج موجود بنفس partNumber:
     - يمكن تحديثه بدلاً من إنشائه (اختياري) أو تجاهله (حسب السياسة).
     - المهم: لا يتم حذف أي منتج موجود.

5) تخزين كل المنتجات في LocalStorage تحت المفتاح المستخدم حاليًا (مثلاً PRODUCTS_KEY).

6) إرجاع عدد الصفوف المفيدة التي تم استيرادها، وعدد الصفوف المتخطاة، وأي رسائل خطأ (مثل صف بدون رقم صنف).

ملاحظات تقنية للاستيراد:

- استخدم دالة مساعدة parseNumber(value) التي:
  - تحوّل القيم النصية أو الرقمية إلى رقم (number) أو null إذا كانت فارغة/خطأ.
- يجب التعامل مع الأرقام حتى لو كانت بداخل Excel كـ string.

━━━━━━━━━━━━━━━━━━
ثالثاً: واجهة صفحة "المنتجات" في لوحة التحكم
━━━━━━━━━━━━━━━━━━

في صفحة AdminProductsPage (صفحة "المنتجات"):

1) أضف زر رئيسي واضح في أعلى الصفحة:

- نص الزر: "استيراد المنتجات من Excel (أونيكس برو)"
- عند النقر:
  - يفتح `<input type="file" accept=".xlsx,.xls">`
  - بعد اختيار الملف يستدعي importProductsFromOnyxExcel(file)
  - يعرض Toast أو رسالة:
    - "تم استيراد X صنف، وتخطي Y صف."

2) تحت زر الاستيراد، ضع نص توضيحي صغير:

"يدعم النظام استيراد ملف الأصناف بنفس تقسيمة نظام أونيكس برو.  
يجب أن يحتوي الملف على أعمدة:  
رقم الصنف، اسم الصنف، سعر التجزئة، سعر الجملة، سعر جملة الجملة، سعر المتجر الالكتروني، كمية المخزن 103، كمية المخزن 105، الإجمالي."

3) جدول عرض المنتجات:

- أعرض على الأقل الأعمدة التالية:

  - رقم الصنف (partNumber)
  - اسم الصنف (name)
  - مستوى التسعير:
    - سعر التجزئة
    - سعر الجملة
    - سعر جملة الجملة
    - سعر المتجر الالكتروني
  - الكمية:
    - qtyStore103
    - qtyStore105
    - qtyTotal

- باقي الحقول (الماركة، اسم السيارة، الرفوف…) يمكن إضافتها لاحقًا، لكن ليست إلزامية الآن.

4) لا تجعل إدخال باقي الحقول (الماركة، المواصفات، سنة الصنع…) إجباري عند إنشاء/تعديل المنتج يدويًا؛ يمكن أن تظل فارغة.

━━━━━━━━━━━━━━━━━━
رابعاً: تصدير نموذج فارغ متوافق مع أونيكس (اختياري مفيد)
━━━━━━━━━━━━━━━━━━

يمكن إضافة زر "تحميل نموذج Excel فارغ" يقوم بإنشاء ملف Excel بنفس الأعمدة وأسمائها بالعربية (حتى لو القيم فارغة)، ليستفيد منه المستخدم عند تجهيز ملفات جديدة.

- الأعمدة في النموذج:
  'رقم الصنف', 'اسم الصنف', 'سعر التجزئة', 'سعر الجملة', 'سعر جملة الجملة', 'سعر المتجر الالكتروني', '  كمية المخزن 103', '  كمية المخزن 105', 'الإجمالي'
- يتم إنشاء الملف عبر xlsx وتحميله للمستخدم.

━━━━━━━━━━━━━━━━━━
خامساً: ملاحظات عامة
━━━━━━━━━━━━━━━━━━

- الهدف الأساسي: أن يستورد النظام ملف الأصناف بنفس تقسيمة نظام أونيكس برو بدون ما يطلب من المستخدم إعادة ترتيب الأعمدة.
- أهم الحقول الإلزامية الآن:
  - partNumber (رقم الصنف)
  - name (اسم الصنف)
- مستويات التسعير والكميات يتم أخذها كما هي من الأعمدة المحددة، وباقي الحقول اختيارية.
- لا يُسمح بمسح أو تعديل البنية الحالية للمنتجات أو الطلبات؛ فقط نضيف دعم للاستيراد من ملف الأكسل بهذه المواصفات.
