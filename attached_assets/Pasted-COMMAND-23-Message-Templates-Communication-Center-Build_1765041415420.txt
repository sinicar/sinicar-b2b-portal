COMMAND 23 — Message Templates & Communication Center

Build a central Message Templates & Communication Center for the whole SINI CAR platform.
The goal: every important system event (quote, order, shipment, account status…) should have configurable templates for WhatsApp, Email, and Internal Notifications, editable from the Admin Panel without touching the code.

Core Models
Create enums MessageEvent and MessageChannel (WHATSAPP, EMAIL, NOTIFICATION).
Add a MessageTemplate model with: id, event, channel, language, name, subject (optional), body, isActive, timestamps.
Add a MessageLog model to store: event, channel, recipient, subject, body, status, errorMessage, timestamps.
Seed a few default templates (AR + EN) for key events like QUOTE_CREATED, QUOTE_APPROVED, PASSWORD_RESET.

Admin UI – Messaging Center
In Admin Panel → Settings, add a Messaging Center page.
Show a table of all MessageEvents with columns: Event, Channels configured, Active templates, Actions.
When opening an event, show tabs per channel (WhatsApp / Email / Notification). For each channel, list templates by language with buttons: Create / Edit / Disable.
In the template form, allow editing: language, name, subject (if email), body, and isActive. Show a side panel with available variables (e.g. {{customerName}}, {{quoteNumber}}, {{status}}, {{link}}). Add a Preview button that renders a sample on the frontend only.

Message Rendering & Sending Pipeline
Implement a simple renderTemplate(body, variables) function on the backend (string interpolation for {{var}} placeholders, no AI).
Add a central service sendEventMessage(event, channel, context) that:

Fetches the active template for (event, channel, language) with fallback to default language.

Renders subject/body using renderTemplate.

Resolves the recipient (phone/email/userId) from the context.

Calls the appropriate provider adapter (WhatsApp, Email, Notification).

Writes an entry to MessageLog with final text and status.

Provider Adapters & Permissions
Create simple provider modules: whatsappProvider, emailProvider, notificationProvider with a unified send() interface; for now they can log to console + MessageLog, but must be ready to plug real APIs later.
Integrate with the existing Permission Matrix by adding capabilities like MANAGE_MESSAGE_TEMPLATES and VIEW_MESSAGE_TEMPLATES, so only authorized roles can change templates or trigger test messages.

Replit Cost & Optimization
Avoid AI in this flow; everything is deterministic string replacement.
When the admin opens Messaging Center, load all templates in one API call and cache them in frontend state.
On the backend, keep a small in-memory cache of active templates per (event, channel, language) with short TTL (e.g. 5–15 minutes) to reduce DB reads when sending messages.
This design minimizes external API calls and database hits, which keeps Replit Autoscale costs low.