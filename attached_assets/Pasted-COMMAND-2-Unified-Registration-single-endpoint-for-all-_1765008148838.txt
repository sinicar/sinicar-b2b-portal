COMMAND 2 — Unified Registration (single endpoint for all public user types)

IMPORTANT — DO NOT DELETE EXISTING AUTH ENDPOINTS OR LOGIC. ONLY EXTEND THEM.
This is an update to the existing SINI CAR system, not a rebuild.

GOAL: Create a unified registration flow for public users

(Customer, Supplier Local, Supplier International, Marketer) using ONE registration endpoint.

1️⃣ Locate the registration endpoint

Find the current signup endpoint in the backend, for example:

POST /api/auth/register (or similar).

This endpoint should become the single unified registration entry point for public users.

2️⃣ Support multiple public roles in registration

Extend the registration endpoint so it accepts a role (or type) field with allowed values:

"CUSTOMER"

"SUPPLIER_LOCAL"

"SUPPLIER_INTERNATIONAL"

"MARKETER"

Do NOT allow creating "ADMIN" users through this public endpoint.

"ADMIN" and "EMPLOYEE" users will be created from the admin panel or seeding only (not in this command).

3️⃣ Required registration fields

For public registration, require at least:

name

whatsapp (phone number — required)

email (optional)

role (one of: CUSTOMER, SUPPLIER_LOCAL, SUPPLIER_INTERNATIONAL, MARKETER)

password (user-chosen password)

When saving the user:

Set status = "PENDING" by default.

Set isCustomer / isSupplier according to the selected role:

If role is "CUSTOMER" → isCustomer = true, isSupplier = false

If role is "SUPPLIER_LOCAL" or "SUPPLIER_INTERNATIONAL" → isSupplier = true

If role is "MARKETER" → both isCustomer and isSupplier can stay false (for now).

4️⃣ Single registration URL

Keep ONE registration URL (e.g. /api/auth/register) and handle the different user types by the role field in the request body.

The frontend can use the same endpoint for:

Customers

Local suppliers

International suppliers

Marketers
by simply changing the role value.

5️⃣ Account status after registration

All newly registered accounts must:

Have status = "PENDING".

NOT be allowed to log in until approved by an admin (the approval logic will be implemented in a separate command).

6️⃣ Validation

Use existing Zod schemas (or add new ones) to:

Validate role is one of the allowed values.

Ensure whatsapp is present and non-empty.

Accept email as optional.

7️⃣ Replit cost rules

Keep the logic simple and efficient:

Exactly one DB write per registration (no unnecessary extra queries).

Do NOT add any AI calls.

Do NOT add background jobs or heavy processing here.

8️⃣ Do NOT modify the frontend in this command

This task is backend-only.

Frontend changes (forms, UI) will be handled in separate commands.