Prompt to Replit Agent – Fix column settings modal + add product visibility rules

Act as a senior front-end engineer.
I want you to fix and enhance the “column settings” modal for Excel import, and also add product visibility rules on the Products page.

1. Fix the “column settings” modal layout

Current issues:

The modal looks cut off (cropped) vertically and horizontally.

Content is not well aligned and feels messy.

Required behavior:

Make the modal responsive and fully visible:

Use a max width (e.g. 900–1000px) centered on the screen.

Use a max height (e.g. 80–90vh) with internal scroll for the content area:

The modal header and footer (title + buttons) must remain fixed.

Only the list of fields/rows scrolls.

Ensure:

No horizontal scrollbar on the overall page.

Inputs and labels are aligned in a clean grid:

Column 1: internal field name (الاسم الداخلي)

Column 2: Excel column name (اسم العمود في Excel)

Column 3: default value (القيمة الافتراضية)

Column 4: any extra controls (enabled/required, etc.)

Keep all labels and buttons in Arabic and consistent with the current design:

Title: "إعداد أعمدة الاستيراد" or the existing title.

Buttons: "حفظ الإعداد", "إلغاء", etc.

2. Add “Add column” feature (unlimited fields)

Currently there is no way to add new custom column mappings.

Required behavior:

At the bottom (or top) of the fields list inside the modal, add a button:

Label: "إضافة عمود جديد"

Clicking it should append a new row with empty inputs:

internal field (select or text)

Excel column name

default value

Allow unlimited rows (within reasonable UI performance).

Each row should have:

A small delete icon/button to remove that mapping.

Optional drag handle to reorder rows (not mandatory but nice if it’s easy).

When saving the preset:

Include all newly added columns in the preset structure.

Persist them properly in the presets storage (mockApi/localStorage).

When loading an existing preset:

All rows (including extra columns that were added) should be restored and displayed in the modal.

3. Product visibility rules in the Products page (hide quantity for customers)

I want the Products page (إدارة المنتجات) to become the main control center for how quantities appear to customers.

Required behavior:

In the Products page, add a “visibility settings” panel or section (either above the table or in a side panel), with:

Numeric input:

Label: "الحد الأدنى لعرض الكمية للعملاء"

Example helper text:

"لن تظهر الكمية للعملاء إذا كانت أقل من هذه القيمة."

Example: if set to 5, then quantities < 5 should be hidden from customers.

Apply the rule on customer-facing views only:

When a customer views products, search results, or any catalog page:

If product.quantity < visibilityThreshold:

Do NOT show the numerical quantity to the customer.

Optionally show a neutral message like: "الكمية محدودة" instead of the exact number.

Selection: apply to all or some products

In the Products table, add a checkbox on each row and a “select all” checkbox in the header.

Add a bulk action dropdown or button group above the table, for example:

"تطبيق قاعدة إخفاء الكمية على المنتجات المحددة"

"إزالة قاعدة إخفاء الكمية من المنتجات المحددة"

Implementation idea:

Add a boolean field per product, e.g. useVisibilityRuleForQty.

If true → this product obeys the global threshold (hide quantity when < threshold).

If false → product always shows quantity as usual, regardless of threshold.

For convenience:

Allow “select all products” and apply the rule in one click.

Allow selecting a subset (by brand, search filter, etc.) and apply/remove the rule.

Persistence and admin view:

Store visibilityThreshold and the per-product flags in mockApi/localStorage.

In the admin Products table, always show the real quantity.

Optionally mark products that use the visibility rule with a small icon or badge like:

"يخضع لقاعدة إخفاء الكمية"

Integration with existing threshold logic:

If there is already a global threshold used to determine “متوفر/غير متوفر”، reuse or align it with this logic if possible.

Make sure customer visibility and stock logic are consistent.

4. Testing & cleanup

Test the column settings modal:

Layout no longer cut off.

Scrolling works correctly.

Adding/removing rows works.

Saving/loading presets includes new columns.

Test product visibility:

Set threshold to 5.

Mark some products to use the visibility rule.

On customer side, quantities < 5 are not shown (or show “الكمية محدودة”), while quantities ≥ 5 show normally.

Changing the threshold updates behavior after refresh or state update.

Ensure there are no TypeScript errors or console errors after these changes.

End of prompt.