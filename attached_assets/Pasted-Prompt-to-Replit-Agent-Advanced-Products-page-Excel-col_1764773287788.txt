Prompt to Replit Agent – Advanced Products page & Excel column presets

Act as a senior full-stack engineer.
I want you to upgrade the Products Management page (إدارة المنتجات) to become the main control center for:

Which products appear to customers (based on quantity thresholds).

How Excel imports map columns to our internal product fields, with reusable column presets.

Do NOT break the existing UI design; keep the same styling and layout style, but add powerful configuration options.

1. Customer visibility based on quantity threshold

Goal: From the Products page, the admin should be able to decide which products are visible to customers based on quantity.

Add a "customer visibility" configuration area above the products table or in the Settings page but clearly linked to this module. It should contain:

A numeric input, for example:
"أقل كمية لظهور المنتج للعملاء"
(minVisibleQty, default = 1 or 0)

Explanation text in Arabic:

"المنتجات التي كميتها أقل من هذه القيمة لن تظهر لعملاء الجملة في المتجر."

Apply this rule only on customer-facing views:

Customer catalog

Search results

Quote/price request product lists

Any other customer side screens

Logic:

if (product.quantity < minVisibleQty) {
  // hide from customers, but still visible for admin/staff
}


On the admin Products page itself:

Always show all products, regardless of quantity.

However, visually indicate low or hidden products:

For example, highlight quantity cells in red if quantity < minVisibleQty.

Optional: small icon or label "مخفي عن العملاء".

Store minVisibleQty in the configuration (mockApi/localStorage) so it persists across reloads.

Make sure this threshold is also reused in the search logic we implemented earlier, so stock and visibility rules are consistent.

2. Advanced column configuration for Excel import

Goal: Before importing an Excel file, the admin should be able to:

Choose which columns are active.

Map Excel columns to internal fields.

Save these mappings as named column presets (مجموعات أعمدة).

Choose a default preset.

2.1 Column settings panel

In the Products page, near the "استيراد من أونيكس" / Excel import button, add a new button:

Label (Arabic): "إعدادات الأعمدة"

When clicked, open a modal or side panel called: "إدارة إعدادات الأعمدة لاستيراد Excel".

In this panel, show a list of all supported internal product fields, for example:

رقم الصنف (partNumber)

اسم المنتج (name)

الماركة (brand)

الكمية (quantity)

سعر الجملة (wholesalePrice)

سعر التجزئة (retailPrice)

رقم الرف… إلخ

For each field allow:

Checkbox: Enabled / Disabled (هل سيتم استخدام هذا الحقل في الاستيراد؟)

Text input: Excel column header / index (اسم العمود في ملف الإكسل الذي يطابق هذا الحقل)

Optional: default value if the column is missing.

Add a toggle or mark for:

"حقل أساسي / Required" for fields like part number and quantity.

2.2 Column presets (مجموعات الأعمدة)

In the same panel, add preset management:

Dropdown to select preset.

Buttons:

"حفظ كإعداد جديد" (Save as new preset)

"تعديل الإعداد الحالي" (Update current preset)

"حذف الإعداد" (Delete preset)

"تعيين كإعداد افتراضي" (Set as default)

Each preset should store:

presetId

presetName (e.g. "Onyx Export", "Supplier A Template", "Chinese Supplier XYZ")

enabled/disabled flags for each field

mapping from Excel column header to internal field

required flags

any default values

Store presets in mockApi/localStorage in a clear structure and load them on app start.

When the user clicks the Excel import button:

If there is a default preset, use that mapping automatically.

Allow the admin to change preset before importing (e.g. select from a dropdown in the import dialog).

During import:

Use the selected preset to map Excel columns → internal fields.

If a required field mapping is missing, show a clear error message in Arabic and block the import until fixed.

3. Products table column visibility (optional but useful)

Use the same column configuration to control which columns are shown in the Products table:

If a field is disabled in the column settings, hide that column from the admin table (optional toggle like "Apply to table view").

Allow the admin to quickly show/hide columns without touching the code.

4. UX & persistence

Ensure all new settings (minVisibleQty, column presets, default preset) are saved and restored on reload.

Make the UI clear and Arabic-friendly:

Proper labels, descriptions, and buttons in Arabic.

No broken layout.

Verify:

Changing minVisibleQty affects which products are visible for customers.

Column presets are created, edited, deleted, and set as default correctly.

Excel imports use the selected preset mappings.

TypeScript builds cleanly and there are no console errors.

End of prompt.