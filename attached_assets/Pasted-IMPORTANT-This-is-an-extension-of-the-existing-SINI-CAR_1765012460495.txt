IMPORTANT — This is an extension of the existing SINI CAR system.
Do NOT delete or modify any existing product, price, or tools pages.
We are ADDING a complete "Alternatives" (بدائل الأصناف) feature.

FOCUS:
- Implement ALL requested features.
- Reduce Replit cost mainly by keeping compute (CPU work) and queries simple.
- No AI calls from inside the code.

GOAL:
Create a full "Alternatives" module where customers can:
1) Upload Excel files containing alternative parts (cross references).
2) Search for a part number and see its alternatives on a dedicated page.
3) (Optional) Allow admin to view/manage the alternatives.

────────────────────────────────
1) Backend – Data model for Alternatives
────────────────────────────────

Add a new model/table for part alternatives, e.g.:

AlternativePart:
- id                (primary key)
- mainPartNumber    (string)   // original/main part number
- altPartNumber     (string)   // alternative / cross-reference part number
- description       (string?)  // optional description
- brand             (string?)  // optional brand (OEM / Aftermarket / etc.)
- sourceType        (string)   // e.g. "CUSTOMER_UPLOAD", "SYSTEM"
- sourceUserId      (optional, FK to User) // who uploaded it
- createdAt         (DateTime)
- updatedAt         (DateTime)

Rules:
- Do NOT change or remove any existing product tables.
- This is a separate table linked logically by part numbers (mainPartNumber / altPartNumber).

────────────────────────────────
2) Backend – Excel Upload Endpoint for Alternatives
────────────────────────────────

Create a new endpoint:
  POST /api/tools/alternatives/upload

Behavior:
- Accept an Excel file (XLSX/CSV) with small/medium size.
- Parse the file on the backend.
- Expected conceptual columns:
  • MAIN_PART      → mainPartNumber
  • ALT_PART       → altPartNumber
  • DESCRIPTION    → description (optional)
  • BRAND          → brand (optional)

For each valid row:
- Insert (or upsert) into AlternativePart:
  - mainPartNumber
  - altPartNumber
  - description
  - brand
  - sourceType = "CUSTOMER_UPLOAD"
  - sourceUserId = current logged-in user (if available)

Important:
- Do NOT store the original Excel file long-term in Replit.
  - Parse → insert rows → discard the file.
- Validate obvious errors (empty mainPartNumber or altPartNumber, etc.).
- Return JSON summary, e.g.:
  {
    "success": true,
    "rowsProcessed": X,
    "rowsInserted": Y,
    "rowsSkipped": Z
  }

Compute/Cost:
- Keep parsing logic simple (no heavy transformations).
- Reject extremely large files (define a max size).

────────────────────────────────
3) Backend – Search API for Alternatives
────────────────────────────────

Create endpoint:
  GET /api/tools/alternatives/search?part=XXXX

Behavior:
- Input: `part` query string (the part number entered by the user).
- Search AlternativePart where:
  - mainPartNumber = part
    OR
  - altPartNumber = part
- Return a lightweight JSON list with:
  - mainPartNumber
  - altPartNumber
  - description
  - brand
  - sourceType
  - (optional) sourceUserId if needed

Optional enhancements (now or later, if easy):
- Case-insensitive search.
- Simple normalization (e.g., trimming spaces).

Compute/Cost:
- Use a simple indexed query (no heavy joins).
- Keep the response small and flat (no nested structures).

────────────────────────────────
4) Frontend – Customer “Alternatives” Page
────────────────────────────────

Add a new page in the **customer portal**:

Name:
- English: "Alternatives"
- Arabic: "بدائل الأصناف"

This page contains TWO main sections:

A) Upload Alternatives Section:
   - A simple file input for Excel.
   - On upload:
     - Call: POST /api/tools/alternatives/upload
     - Show loading while processing.
     - Show summary from the API:
       • rowsProcessed
       • rowsInserted
       • rowsSkipped
   - Display error messages for:
     - Invalid file format
     - Too large file
     - Server error

B) Search Alternatives Section:
   - An input field for part number.
   - "Search" button that calls:
       GET /api/tools/alternatives/search?part=...
   - Results table, with columns:
     - Main Part Number
     - Alternative Part Number
     - Description
     - Brand
     - Source (Customer/System)
   - If no results:
     - Show "No alternatives found" message in both AR/EN if multi-language is in place.

UI/UX:
- Use existing design system (React + Tailwind).
- Keep layout clean:
  - Upload block at top or left.
  - Search block with results below or right.

────────────────────────────────
5) Admin – Optional Alternatives Management View
────────────────────────────────

Add an admin-only screen (can be simple initially):

- Menu entry in Admin Panel:
  - "Alternatives Management"

Screen content:
- Table listing AlternativePart records:
  - mainPartNumber
  - altPartNumber
  - description
  - brand
  - sourceType
  - sourceUserId (optional: show uploader name if easy to join with User)
  - createdAt
- Optional actions (implement now or in later commands):
  - Delete an alternative mapping.
  - Mark alternative as approved/verified if you add such a field later.

Compute/Cost:
- If data grows, add pagination (page, pageSize).
- Use simple queries; no complex filtering logic in the backend for now.

────────────────────────────────
6) Permissions
────────────────────────────────

- Customer Portal:
  - Only logged-in customers (and optionally suppliers) can access the "Alternatives" page.
- Admin Portal:
  - Only admin users can access "Alternatives Management".

Use and extend the existing auth/role system.
Do NOT weaken or remove any existing security checks.

────────────────────────────────
7) Replit Cost & Compute Rules (without removing features)
────────────────────────────────

- Implement ALL the functionality above; do NOT skip features just to save cost.
- Reduce cost by reducing compute and complexity:
  • No AI calls from backend or frontend.
  • No background jobs, cron, or infinite loops.
  • Keep Excel parsing straightforward (row-by-row, no complex conversions).
  • Use simple indexed queries for search.
  • Limit file size to avoid very heavy parsing.
  • Return only necessary fields in JSON (avoid extra heavy data).

Storage:
- It is acceptable to store the **rows** (alternative mappings) in the database.
- Do NOT keep the raw Excel files permanently in Replit.

────────────────────────────────
8) Scope of this command
────────────────────────────────

- This command ONLY covers:
  - Alternatives data model (AlternativePart).
  - Upload API for alternatives.
  - Search API for alternatives.
  - Customer "Alternatives" page.
  - Optional basic Admin view for alternatives.
- Do NOT modify the main product search page in this command.
  Integration between main product search and alternatives will be handled in another command.
